<div class="bank-account-container">
  <div class="page-header">
    <h1>Quáº£n lÃ½ tÃ i khoáº£n ngÃ¢n hÃ ng</h1>
    <p class="subtitle">Cáº­p nháº­t thÃ´ng tin tÃ i khoáº£n ngÃ¢n hÃ ng Ä‘á»ƒ nháº­n thanh toÃ¡n tá»« há»c viÃªn</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Äang táº£i thÃ´ng tin...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-message">
    <i class="icon">âš ï¸</i>
    {{ errorMessage }}
  </div>

  <!-- Bank Account Form -->
  <div *ngIf="!isLoading" class="bank-account-card">
    <!-- Verification Status -->
    <div *ngIf="hasExistingAccount && !isEditing" class="verification-status">
      <div class="status-badge" [class.verified]="bankAccount.is_verified" [class.pending]="!bankAccount.is_verified">
        <i class="icon">{{ bankAccount.is_verified ? 'âœ“' : 'â³' }}</i>
        <span>{{ bankAccount.is_verified ? 'ÄÃ£ xÃ¡c thá»±c' : 'Chá» xÃ¡c thá»±c' }}</span>
      </div>
      <p class="status-note" *ngIf="!bankAccount.is_verified">
        TÃ i khoáº£n cá»§a báº¡n Ä‘ang chá» admin xÃ¡c thá»±c. Trong thá»i gian nÃ y, há»c viÃªn sáº½ thanh toÃ¡n vÃ o tÃ i khoáº£n máº·c Ä‘á»‹nh cá»§a há»‡ thá»‘ng.
      </p>
    </div>

    <!-- View Mode -->
    <div *ngIf="!isEditing && hasExistingAccount" class="view-mode">
      <div class="info-group">
        <label>NgÃ¢n hÃ ng</label>
        <p class="info-value">{{ bankAccount.bank_name }}</p>
      </div>

      <div class="info-group">
        <label>Sá»‘ tÃ i khoáº£n</label>
        <p class="info-value">{{ maskAccountNumber(bankAccount.account_number) }}</p>
      </div>

      <div class="info-group">
        <label>TÃªn chá»§ tÃ i khoáº£n</label>
        <p class="info-value">{{ bankAccount.account_name }}</p>
      </div>

      <div class="info-group" *ngIf="bankAccount.branch">
        <label>Chi nhÃ¡nh</label>
        <p class="info-value">{{ bankAccount.branch }}</p>
      </div>

      <div class="info-group" *ngIf="bankAccount.notes">
        <label>Ghi chÃº</label>
        <p class="info-value">{{ bankAccount.notes }}</p>
      </div>

      <div class="action-buttons">
        <button class="btn btn-primary" (click)="enableEdit()">
          <i class="icon">âœï¸</i> Chá»‰nh sá»­a
        </button>
        <button class="btn btn-danger" (click)="deleteBankAccount()">
          <i class="icon">ğŸ—‘ï¸</i> XÃ³a
        </button>
      </div>
    </div>

    <!-- Edit Mode -->
    <form *ngIf="isEditing" (ngSubmit)="saveBankAccount()" class="edit-mode">
      <div class="form-group">
        <label for="bank_name">NgÃ¢n hÃ ng <span class="required">*</span></label>
        <select 
          id="bank_name" 
          [(ngModel)]="bankAccount.bank_name" 
          name="bank_name"
          class="form-control"
          required>
          <option value="">-- Chá»n ngÃ¢n hÃ ng --</option>
          <option *ngFor="let bank of popularBanks" [value]="bank">{{ bank }}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="account_number">Sá»‘ tÃ i khoáº£n <span class="required">*</span></label>
        <input 
          type="text" 
          id="account_number" 
          [(ngModel)]="bankAccount.account_number" 
          name="account_number"
          class="form-control"
          placeholder="Nháº­p sá»‘ tÃ i khoáº£n"
          required>
      </div>

      <div class="form-group">
        <label for="account_name">TÃªn chá»§ tÃ i khoáº£n <span class="required">*</span></label>
        <input 
          type="text" 
          id="account_name" 
          [(ngModel)]="bankAccount.account_name" 
          name="account_name"
          class="form-control"
          placeholder="Nháº­p tÃªn chá»§ tÃ i khoáº£n (viáº¿t hoa, khÃ´ng dáº¥u)"
          required>
        <small class="form-hint">VÃ­ dá»¥: NGUYEN VAN A</small>
      </div>

      <div class="form-group">
        <label for="branch">Chi nhÃ¡nh</label>
        <input 
          type="text" 
          id="branch" 
          [(ngModel)]="bankAccount.branch" 
          name="branch"
          class="form-control"
          placeholder="Nháº­p tÃªn chi nhÃ¡nh (khÃ´ng báº¯t buá»™c)">
      </div>

      <div class="form-group">
        <label for="notes">Ghi chÃº</label>
        <textarea 
          id="notes" 
          [(ngModel)]="bankAccount.notes" 
          name="notes"
          class="form-control"
          rows="3"
          placeholder="Ghi chÃº thÃªm (khÃ´ng báº¯t buá»™c)"></textarea>
      </div>

      <div class="action-buttons">
        <button type="submit" class="btn btn-primary" [disabled]="isSaving">
          <span *ngIf="!isSaving">
            <i class="icon">ğŸ’¾</i> {{ hasExistingAccount ? 'Cáº­p nháº­t' : 'LÆ°u' }}
          </span>
          <span *ngIf="isSaving">
            <i class="icon spinner-small">â³</i> Äang lÆ°u...
          </span>
        </button>
        <button type="button" class="btn btn-secondary" (click)="cancelEdit()" [disabled]="isSaving">
          Há»§y
        </button>
      </div>
    </form>

    <!-- Info Box -->
    <div class="info-box">
      <h3>ğŸ“Œ LÆ°u Ã½ quan trá»ng</h3>
      <ul>
        <li>ThÃ´ng tin tÃ i khoáº£n ngÃ¢n hÃ ng sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ nháº­n thanh toÃ¡n tá»« há»c viÃªn Ä‘Äƒng kÃ½ khÃ³a há»c cá»§a báº¡n.</li>
        <li>Vui lÃ²ng cung cáº¥p thÃ´ng tin chÃ­nh xÃ¡c Ä‘á»ƒ trÃ¡nh sai sÃ³t trong quÃ¡ trÃ¬nh thanh toÃ¡n.</li>
        <li>TÃ i khoáº£n cáº§n Ä‘Æ°á»£c admin xÃ¡c thá»±c trÆ°á»›c khi cÃ³ thá»ƒ sá»­ dá»¥ng.</li>
        <li>Náº¿u chÆ°a Ä‘Æ°á»£c xÃ¡c thá»±c, há»c viÃªn sáº½ thanh toÃ¡n vÃ o tÃ i khoáº£n máº·c Ä‘á»‹nh cá»§a há»‡ thá»‘ng.</li>
      </ul>
    </div>
  </div>
</div>

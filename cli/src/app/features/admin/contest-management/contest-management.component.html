<!-- Admin Contest Management Page -->
<div
  class="min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200"
>
  <!-- Header -->
  <div
    class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 transition-colors duration-200"
  >
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div
        class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 sm:gap-6"
      >
        <!-- Title -->
        <div class="min-w-0 flex-1">
          <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-1 sm:mb-2">
            Contest Management
          </h1>
          <p class="text-sm sm:text-base text-gray-600 dark:text-gray-400">
            Manage contests, track statistics, and perform bulk operations
          </p>
        </div>

        <!-- Top Actions -->
        <div class="flex flex-wrap items-center gap-2 sm:gap-3 flex-shrink-0">
          <!-- Export Buttons -->
          <div class="flex items-center gap-2">
            <button
              (click)="onExport('json')"
              class="px-3 sm:px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors duration-200"
            >
              <i class="icon-download mr-1 sm:mr-2"></i>
              <span class="hidden sm:inline">Export JSON</span>
              <span class="sm:hidden">JSON</span>
            </button>
            <button
              (click)="onExport('csv')"
              class="px-3 sm:px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors duration-200"
            >
              <i class="icon-file-text mr-1 sm:mr-2"></i>
              <span class="hidden sm:inline">Export CSV</span>
              <span class="sm:hidden">CSV</span>
            </button>
          </div>

          <!-- Create Contest Button -->
          <button
            (click)="onCreateContest()"
            class="px-4 sm:px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm sm:text-base font-medium rounded-lg transition-colors duration-200"
          >
            <i class="icon-plus mr-1 sm:mr-2"></i>
            <span class="hidden sm:inline">Create Contest</span>
            <span class="sm:hidden">Create</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <app-contest-stats
      [stats]="stats"
      [loading]="loading && !stats"
    ></app-contest-stats>
  </div>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-8">
    <!-- Tabs -->
    <div class="mb-4 sm:mb-6 overflow-x-auto">
      <nav class="flex space-x-4 sm:space-x-8 min-w-max" aria-label="Tabs">
        <button
          (click)="onTabChange('all')"
          [ngClass]="{
            'border-blue-500 text-blue-600 dark:text-blue-400':
              activeTab === 'all',
            'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600':
              activeTab !== 'all'
          }"
          class="whitespace-nowrap py-2 px-1 sm:px-2 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200"
        >
          <span class="hidden sm:inline">All Contests</span>
          <span class="sm:hidden">All</span>
          <span
            *ngIf="stats"
            class="ml-1 sm:ml-2 px-1.5 sm:px-2 py-0.5 sm:py-1 text-xs bg-gray-100 dark:bg-gray-700 rounded-full"
          >
            {{ stats.totalContests }}
          </span>
        </button>

        <button
          (click)="onTabChange('deleted')"
          [ngClass]="{
            'border-red-500 text-red-600 dark:text-red-400':
              activeTab === 'deleted',
            'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600':
              activeTab !== 'deleted'
          }"
          class="whitespace-nowrap py-2 px-1 sm:px-2 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200"
        >
          <span class="hidden sm:inline">Deleted Contests</span>
          <span class="sm:hidden">Deleted</span>
          <span
            *ngIf="stats"
            class="ml-1 sm:ml-2 px-1.5 sm:px-2 py-0.5 sm:py-1 text-xs bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded-full"
          >
            {{ stats.deletedContests }}
          </span>
        </button>
      </nav>
    </div>

    <!-- Search Bar -->
    <div class="mb-4 sm:mb-6">
      <div class="relative">
        <div
          class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
        >
          <i class="icon-search text-gray-400 text-base sm:text-lg"></i>
        </div>
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (keyup.enter)="onSearch(searchTerm)"
          (input)="onSearch(searchTerm)"
          placeholder="Search contests..."
          class="w-full pl-9 sm:pl-10 pr-8 sm:pr-10 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
        />
        <button
          *ngIf="searchTerm"
          (click)="searchTerm = ''; onSearch('')"
          class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors duration-200"
        >
          <i class="icon-x text-lg"></i>
        </button>
      </div>
    </div>

    <!-- Filters Section -->
    <div class="mb-4 sm:mb-6">
      <app-contest-filters
        [filters]="filters"
        (filtersChange)="onFiltersChange($event)"
      ></app-contest-filters>
    </div>

    <!-- Bulk Actions Bar -->
    <app-bulk-actions
      *ngIf="showBulkActions"
      [selectedCount]="selectedContests.length"
      [showRestoreAction]="false"
      (bulkAction)="onBulkAction($event)"
      (clearSelection)="selectedContests = []; showBulkActions = false"
      class="mb-6"
    ></app-bulk-actions>

    <!-- Contest List -->
    <app-contest-list
      [contests]="contests"
      [loading]="loading"
      [error]="error"
      [selectedContestIds]="selectedContests"
      [currentPage]="currentPage"
      [totalPages]="totalPages"
      [totalItems]="totalItems"
      [itemsPerPage]="itemsPerPage"
      [sortBy]="sortBy"
      [sortOrder]="sortOrder"
      [showDeletedActions]="activeTab === 'deleted'"
      (contestToggle)="onContestToggle($event)"
      (selectAll)="onSelectAll($event)"
      (viewContest)="onViewContest($event)"
      (editContest)="onEditContest($event)"
      (deleteContest)="onDeleteContest($event)"
      (restoreContest)="onRestoreContest($event)"
      (permanentlyDeleteContest)="onPermanentlyDeleteContest($event)"
      (manageProblems)="onManageProblems($event)"
      (manageParticipants)="onManageParticipants($event)"
      (sortChange)="onSortChange($event)"
      (pageChange)="onPageChange($event)"
    ></app-contest-list>
  </div>

  <!-- Contest Form Modal -->
  <app-contest-form
    *ngIf="isFormModalOpen"
    [contest]="editingContest"
    [isEdit]="!!editingContest"
    (contestCreated)="onContestCreated($event)"
    (contestUpdated)="onContestUpdated($event)"
    (close)="onCloseForm()"
  ></app-contest-form>

  <!-- Contest Problems Management Modal -->
  <app-contest-problems
    *ngIf="isProblemsModalOpen && managingProblemsContest"
    [contest]="managingProblemsContest"
    (close)="onCloseProblemsModal()"
    (problemsUpdated)="onProblemsUpdated()"
  ></app-contest-problems>

  <!-- Contest Participants Management Modal -->
  <app-contest-participants
    *ngIf="isParticipantsModalOpen && managingParticipantsContest"
    [contest]="managingParticipantsContest"
    (close)="onCloseParticipantsModal()"
    (participantsUpdated)="onParticipantsUpdated()"
  ></app-contest-participants>
</div>
